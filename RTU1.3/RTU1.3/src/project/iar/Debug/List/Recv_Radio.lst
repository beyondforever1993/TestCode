###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.50.6.4896/W32 for ARM      26/Mar/2017  12:36:51 #
# Copyright 1999-2013 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  D:\wangfan2\桌面\RTU_1.2\HuaceApp\DEVICE_GPRS\Recv_Radio #
#                    .c                                                       #
#    Command line =  D:\wangfan2\桌面\RTU_1.2\HuaceApp\DEVICE_GPRS\Recv_Radio #
#                    .c -lCN D:\wangfan2\桌面\RTU_1.2\project\iar\Debug\List\ #
#                     -o D:\wangfan2\桌面\RTU_1.2\project\iar\Debug\Obj\      #
#                    --no_cse --no_unroll --no_inline --no_code_motion        #
#                    --no_tbaa --no_clustering --no_scheduling --debug        #
#                    --endian=little --cpu=Cortex-M3 -e --fpu=None            #
#                    --dlib_config "C:\Program Files (x86)\IAR                #
#                    Systems\Embedded Workbench 6.5_2\arm\INC\c\DLib_Config_F #
#                    ull.h" -I D:\wangfan2\桌面\RTU_1.2\project\iar\ -I       #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\ -I       #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\ADC\ -I   #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\RTC\ -I   #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\TILT\ -I  #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\RDLevel\  #
#                    -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\RS232\ #
#                     -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\OS-v2 #
#                    \ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\Vibr #
#                    ationString\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\ #
#                    ..\ucos2\uCOS-II\Ports\ARM-Cortex-M3\Generic\IAR\ -I     #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\ucos2\uCOS-II #
#                    \Source\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\u #
#                    cos2\uC-LIB\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\ #
#                    ..\ucos2\uC-CPU\ -I D:\wangfan2\桌面\RTU_1.2\project\iar #
#                    \..\..\ucos2\uC-CPU\ARM-Cortex-M3\IAR\ -I                #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\cmsis\Drivers #
#                    \source\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\c #
#                    msis\Drivers\include\ -I D:\wangfan2\桌面\RTU_1.2\projec #
#                    t\iar\..\..\app\ -I D:\wangfan2\桌面\RTU_1.2\project\iar #
#                    \..\..\uC-Probe\Target\Plugins\uCOS-II\ -I               #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\uC-Probe\Targ #
#                    et\Demos\Intro\Workspaces\ -I                            #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\uC-Probe\Targ #
#                    et\Demos\Intro\Source\ -I D:\wangfan2\桌面\RTU_1.2\proje #
#                    ct\iar\..\..\uC-Probe\Target\Communication\Generic\Sourc #
#                    e\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\uC-Prob #
#                    e\Target\Communication\Generic\RS-232\Source\ -I         #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\uC-Probe\Targ #
#                    et\Communication\Generic\RS-232\Ports\NXP\LPC17xx\ -I    #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\uC-Probe\Targ #
#                    et\Communication\Generic\RS-232\OS\uCOS-II\ -I           #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\cmsis\Core\CM #
#                    3\CoreSupport\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\. #
#                    .\..\cmsis\Core\CM3\DeviceSupport\NXP\LPC177x_8x\ -I     #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\HuaceApp\ -I  #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\HuaceApp\DEVI #
#                    CE_BT\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\Hua #
#                    ceApp\DEVICE_COM\ -I D:\wangfan2\桌面\RTU_1.2\project\ia #
#                    r\..\..\HuaceApp\DEVICE_GPRS\ -I                         #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\HuaceApp\DEVI #
#                    CE_GPS\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\Hu #
#                    aceApp\DEVICE_RADIO\ -I D:\wangfan2\桌面\RTU_1.2\project #
#                    \iar\..\..\HuaceApp\iap\ -I                              #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\FatFs\ -I     #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\USB\ -I       #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\bsp\spi_flash #
#                    \ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\HuaceApp #
#                    \LED\ -On --use_c++_inline                               #
#    List file    =  D:\wangfan2\桌面\RTU_1.2\project\iar\Debug\List\Recv_Rad #
#                    io.lst                                                   #
#    Object file  =  D:\wangfan2\桌面\RTU_1.2\project\iar\Debug\Obj\Recv_Radi #
#                    o.o                                                      #
#                                                                             #
#                                                                             #
###############################################################################

D:\wangfan2\桌面\RTU_1.2\HuaceApp\DEVICE_GPRS\Recv_Radio.c
      1          /**************************Copyright (C) 2003-2014. All rights reserved*********************************
      2          **                                  上海华测导航科技有限公司
      3          **                                  http://www.huace.cn
      4          **                                  Email:support@huace.cn
      5          **
      6          **--------------文件信息--------------------------------------------------------------------------------
      7          **文   件   名: Recv_Radio.c
      8          **创   建   人:
      9          **最后修改日期: 2014年08月12日
     10          **描        述: 电台处理，包括电台初始化，接收数据处理，发送数据处理，电台分类等
     11          ********************************************************************************************************/
     12          
     13          #include "includes.h"
     14          
     15          
     16          
     17          
     18          //Add by xhz 2011.8.19
     19          //电台接受数据处理缓冲区

   \                                 In section .bss, align 4
     20          unsigned  char Radio_Data_Process_Buffer[Radio_Data_Process_Buffer_Size];
   \                     Radio_Data_Process_Buffer:
   \   00000000                      DS8 1024

   \                                 In section .bss, align 2
     21          unsigned  short Radio_Data_Len = 0;
   \                     Radio_Data_Len:
   \   00000000                      DS8 2

   \                                 In section .bss, align 2
     22          unsigned  short Radio_Data_RdSp = 0;
   \                     Radio_Data_RdSp:
   \   00000000                      DS8 2
     23          
     24          
     25          
     26          #pragma location="LARGE_DATA_RAM" //add by xxw 20140819 放到外围32k的SRAM中去

   \                                 In section LARGE_DATA_RAM, align 4
     27          unsigned char g_aSPI_Data_Buf[256];
   \                     g_aSPI_Data_Buf:
   \   00000000                      DS8 256

   \                                 In section .bss, align 1
     28          unsigned char b1,b2;
   \                     b1:
   \   00000000                      DS8 1

   \                                 In section .bss, align 1
   \                     b2:
   \   00000000                      DS8 1
     29          //unsigned char buf_sp=0,buf_sp2=0; //  写，读指针

   \                                 In section .bss, align 1
     30          unsigned char buf_sp=0,buf_sp2=0; //  写，读指针
   \                     buf_sp:
   \   00000000                      DS8 1

   \                                 In section .bss, align 1
   \                     buf_sp2:
   \   00000000                      DS8 1

   \                                 In section .bss, align 1
     31          unsigned char buf2_full=0 ;
   \                     buf2_full:
   \   00000000                      DS8 1
     32          // unsigned int  Radio_Data_Len=0;

   \                                 In section .bss, align 2
     33          unsigned short rec_temp_sp=0;
   \                     rec_temp_sp:
   \   00000000                      DS8 2

   \                                 In section .bss, align 1
     34          unsigned char head_check_flag = 0;
   \                     head_check_flag:
   \   00000000                      DS8 1
     35          

   \                                 In section .bss, align 1
     36          unsigned char Radio_Type;
   \                     Radio_Type:
   \   00000000                      DS8 1
     37          

   \                                 In section .bss, align 1
     38          unsigned char head_flag=0;
   \                     head_flag:
   \   00000000                      DS8 1

   \                                 In section .bss, align 1
     39          unsigned char cc_num=0,bshift=0;
   \                     cc_num:
   \   00000000                      DS8 1

   \                                 In section .bss, align 1
   \                     bshift:
   \   00000000                      DS8 1

   \                                 In section .bss, align 4
     40          unsigned char rec_buf1[12][3];
   \                     rec_buf1:
   \   00000000                      DS8 36

   \                                 In section .bss, align 4
     41          unsigned short rec_buf2[20];
   \                     rec_buf2:
   \   00000000                      DS8 40

   \                                 In section .bss, align 2
     42          unsigned short dat_length=0;
   \                     dat_length:
   \   00000000                      DS8 2

   \                                 In section .bss, align 4
     43          unsigned char rec_temp[31];	 //接受到的SPI数据
   \                     rec_temp:
   \   00000000                      DS8 32
     44          
     45          
     46          
     47          
     48          
     49          
     50          //========================================================trimble==============================================================
     51          #pragma location="LARGE_DATA_RAM" //add by xxw 20140819 放到外围32k的SRAM中去

   \                                 In section LARGE_DATA_RAM, align 4
     52          unsigned char input_data[460];  			   
   \                     input_data:
   \   00000000                      DS8 460
     53          

   \                                 In section .bss, align 2
     54          unsigned short data_length = 0;
   \                     data_length:
   \   00000000                      DS8 2
     55          
     56          
     57          
     58          
     59          
     60          
     61          
     62          
     63          
     64          
     65          
     66          

   \                                 In section .bss, align 1
     67          unsigned char group_change_last_flag;
   \                     group_change_last_flag:
   \   00000000                      DS8 1

   \                                 In section .bss, align 1
     68          unsigned char Radio_New_Flag = 0; //新版radio标志		 //2010.9.22
   \                     Radio_New_Flag:
   \   00000000                      DS8 1

   \                                 In section .bss, align 1
     69          unsigned char Low_Frequence_Radio = 0;//高低频电台区分  0 -高频     1-低频	 	 	  //2010.9.26
   \                     Low_Frequence_Radio:
   \   00000000                      DS8 1
     70          
     71          
     72          
     73          
     74          //发射电台设置命令标志

   \                                 In section .bss, align 1
     75          unsigned char TR_RADIO_Set_Flag = 0;
   \                     TR_RADIO_Set_Flag:
   \   00000000                      DS8 1
     76          
     77          
     78          
     79          #pragma location="LARGE_DATA_RAM" //add by xxw 20140819 放到外围32k的SRAM中去
     80          
     81          
     82          //采用这种方法产生的高电平或低电平的时间为 3 * Time * _nop_()

   \                                 In section LARGE_DATA_RAM, align 2, keep-with-next
     83          void Delay(unsigned short Time)
     84          {
     85              unsigned short i = 0;
   \                     Delay:
   \   00000000   0x2100             MOVS     R1,#+0
     86              for(i = 0; i< 11*Time; i++)
   \   00000002   0x2200             MOVS     R2,#+0
   \   00000004   0x0011             MOVS     R1,R2
   \                     ??Delay_0:
   \   00000006   0xB289             UXTH     R1,R1            ;; ZeroExt  R1,R1,#+16,#+16
   \   00000008   0xB280             UXTH     R0,R0            ;; ZeroExt  R0,R0,#+16,#+16
   \   0000000A   0x220B             MOVS     R2,#+11
   \   0000000C   0xFB02 0xF200      MUL      R2,R2,R0
   \   00000010   0x4291             CMP      R1,R2
   \   00000012   0xDA01             BGE.N    ??Delay_1
   \   00000014   0x1C49             ADDS     R1,R1,#+1
   \   00000016   0xE7F6             B.N      ??Delay_0
     87              {
     88              }
     89          }
   \                     ??Delay_1:
   \   00000018   0x4770             BX       LR               ;; return
     90          
     91          
     92          
     93          
     94          
     95          

   \                                 In section .text, align 4, keep-with-next
     96          void shift(unsigned char times)
     97          {
     98              unsigned char i;
     99          
    100              for(i = 0; i < times; i++)	 //at most 7 time for a byte
   \                     shift:
   \   00000000   0x2200             MOVS     R2,#+0
   \   00000002   0x0011             MOVS     R1,R2
   \                     ??shift_0:
   \   00000004   0xB2C9             UXTB     R1,R1            ;; ZeroExt  R1,R1,#+24,#+24
   \   00000006   0xB2C0             UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000008   0x4281             CMP      R1,R0
   \   0000000A   0xD220             BCS.N    ??shift_1
    101              {
    102                  if((b1 & 0x80) == 0x80)//b0 high -b1 low
   \   0000000C   0x4A10             LDR.N    R2,??shift_2
   \   0000000E   0x7812             LDRB     R2,[R2, #+0]
   \   00000010   0x0612             LSLS     R2,R2,#+24
   \   00000012   0xD510             BPL.N    ??shift_3
    103                  {
    104                      b2 <<= 1;	//high bit of byte
   \   00000014   0x4A0F             LDR.N    R2,??shift_2+0x4
   \   00000016   0x7812             LDRB     R2,[R2, #+0]
   \   00000018   0x0052             LSLS     R2,R2,#+1
   \   0000001A   0x4B0E             LDR.N    R3,??shift_2+0x4
   \   0000001C   0x701A             STRB     R2,[R3, #+0]
    105                      b2 |= 0x01;	  //?
   \   0000001E   0x4A0D             LDR.N    R2,??shift_2+0x4
   \   00000020   0x7812             LDRB     R2,[R2, #+0]
   \   00000022   0xF052 0x0201      ORRS     R2,R2,#0x1
   \   00000026   0x4B0B             LDR.N    R3,??shift_2+0x4
   \   00000028   0x701A             STRB     R2,[R3, #+0]
    106                      b1 <<= 1;	//remain bits
   \   0000002A   0x4A09             LDR.N    R2,??shift_2
   \   0000002C   0x7812             LDRB     R2,[R2, #+0]
   \   0000002E   0x0052             LSLS     R2,R2,#+1
   \   00000030   0x4B07             LDR.N    R3,??shift_2
   \   00000032   0x701A             STRB     R2,[R3, #+0]
   \   00000034   0xE009             B.N      ??shift_4
    107                  }
    108                  else
    109                  {
    110                      b2 <<= 1;	//high bit of byte
   \                     ??shift_3:
   \   00000036   0x4A07             LDR.N    R2,??shift_2+0x4
   \   00000038   0x7812             LDRB     R2,[R2, #+0]
   \   0000003A   0x0052             LSLS     R2,R2,#+1
   \   0000003C   0x4B05             LDR.N    R3,??shift_2+0x4
   \   0000003E   0x701A             STRB     R2,[R3, #+0]
    111                      b1 <<= 1;	//remain bits
   \   00000040   0x4A03             LDR.N    R2,??shift_2
   \   00000042   0x7812             LDRB     R2,[R2, #+0]
   \   00000044   0x0052             LSLS     R2,R2,#+1
   \   00000046   0x4B02             LDR.N    R3,??shift_2
   \   00000048   0x701A             STRB     R2,[R3, #+0]
    112                  }	
    113              }
   \                     ??shift_4:
   \   0000004A   0x1C49             ADDS     R1,R1,#+1
   \   0000004C   0xE7DA             B.N      ??shift_0
    114          }
   \                     ??shift_1:
   \   0000004E   0x4770             BX       LR               ;; return
   \                     ??shift_2:
   \   00000050   0x........         DC32     b1
   \   00000054   0x........         DC32     b2
    115          
    116          
    117          
    118          
    119          

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       0   Delay
       0   shift


   Section sizes:

   Bytes  Function/Label
   -----  --------------
      26  Delay
       1  Low_Frequence_Radio
       2  Radio_Data_Len
    1024  Radio_Data_Process_Buffer
       2  Radio_Data_RdSp
       1  Radio_New_Flag
       1  Radio_Type
       1  TR_RADIO_Set_Flag
       1  b1
       1  b2
       1  bshift
       1  buf2_full
       1  buf_sp
       1  buf_sp2
       1  cc_num
       2  dat_length
       2  data_length
     256  g_aSPI_Data_Buf
       1  group_change_last_flag
       1  head_check_flag
       1  head_flag
     460  input_data
      36  rec_buf1
      40  rec_buf2
      32  rec_temp
       2  rec_temp_sp
      88  shift

 
 1 156 bytes in section .bss
    88 bytes in section .text
   742 bytes in section LARGE_DATA_RAM
 
   114 bytes of CODE memory
 1 872 bytes of DATA memory

Errors: none
Warnings: 1
