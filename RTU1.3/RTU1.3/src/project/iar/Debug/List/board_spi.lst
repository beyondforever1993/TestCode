###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.50.6.4896/W32 for ARM      26/Mar/2017  12:36:52 #
# Copyright 1999-2013 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  D:\wangfan2\桌面\RTU_1.2\bsp\board_spi.c                 #
#    Command line =  D:\wangfan2\桌面\RTU_1.2\bsp\board_spi.c -lCN            #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\Debug\List\ -o      #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\Debug\Obj\          #
#                    --no_cse --no_unroll --no_inline --no_code_motion        #
#                    --no_tbaa --no_clustering --no_scheduling --debug        #
#                    --endian=little --cpu=Cortex-M3 -e --fpu=None            #
#                    --dlib_config "C:\Program Files (x86)\IAR                #
#                    Systems\Embedded Workbench 6.5_2\arm\INC\c\DLib_Config_F #
#                    ull.h" -I D:\wangfan2\桌面\RTU_1.2\project\iar\ -I       #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\ -I       #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\ADC\ -I   #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\RTC\ -I   #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\TILT\ -I  #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\RDLevel\  #
#                    -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\RS232\ #
#                     -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\OS-v2 #
#                    \ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\BSP\Vibr #
#                    ationString\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\ #
#                    ..\ucos2\uCOS-II\Ports\ARM-Cortex-M3\Generic\IAR\ -I     #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\ucos2\uCOS-II #
#                    \Source\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\u #
#                    cos2\uC-LIB\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\ #
#                    ..\ucos2\uC-CPU\ -I D:\wangfan2\桌面\RTU_1.2\project\iar #
#                    \..\..\ucos2\uC-CPU\ARM-Cortex-M3\IAR\ -I                #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\cmsis\Drivers #
#                    \source\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\c #
#                    msis\Drivers\include\ -I D:\wangfan2\桌面\RTU_1.2\projec #
#                    t\iar\..\..\app\ -I D:\wangfan2\桌面\RTU_1.2\project\iar #
#                    \..\..\uC-Probe\Target\Plugins\uCOS-II\ -I               #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\uC-Probe\Targ #
#                    et\Demos\Intro\Workspaces\ -I                            #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\uC-Probe\Targ #
#                    et\Demos\Intro\Source\ -I D:\wangfan2\桌面\RTU_1.2\proje #
#                    ct\iar\..\..\uC-Probe\Target\Communication\Generic\Sourc #
#                    e\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\uC-Prob #
#                    e\Target\Communication\Generic\RS-232\Source\ -I         #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\uC-Probe\Targ #
#                    et\Communication\Generic\RS-232\Ports\NXP\LPC17xx\ -I    #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\uC-Probe\Targ #
#                    et\Communication\Generic\RS-232\OS\uCOS-II\ -I           #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\cmsis\Core\CM #
#                    3\CoreSupport\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\. #
#                    .\..\cmsis\Core\CM3\DeviceSupport\NXP\LPC177x_8x\ -I     #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\HuaceApp\ -I  #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\HuaceApp\DEVI #
#                    CE_BT\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\Hua #
#                    ceApp\DEVICE_COM\ -I D:\wangfan2\桌面\RTU_1.2\project\ia #
#                    r\..\..\HuaceApp\DEVICE_GPRS\ -I                         #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\HuaceApp\DEVI #
#                    CE_GPS\ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\Hu #
#                    aceApp\DEVICE_RADIO\ -I D:\wangfan2\桌面\RTU_1.2\project #
#                    \iar\..\..\HuaceApp\iap\ -I                              #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\FatFs\ -I     #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\USB\ -I       #
#                    D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\bsp\spi_flash #
#                    \ -I D:\wangfan2\桌面\RTU_1.2\project\iar\..\..\HuaceApp #
#                    \LED\ -On --use_c++_inline                               #
#    List file    =  D:\wangfan2\桌面\RTU_1.2\project\iar\Debug\List\board_sp #
#                    i.lst                                                    #
#    Object file  =  D:\wangfan2\桌面\RTU_1.2\project\iar\Debug\Obj\board_spi #
#                    .o                                                       #
#                                                                             #
#                                                                             #
###############################################################################

D:\wangfan2\桌面\RTU_1.2\bsp\board_spi.c
      1          
      2          #include "includes.h"

   \                                 In section .text, align 2, keep-with-next
   \   static __interwork __softfp void NVIC_EnableIRQ(IRQn_Type)
   \                     NVIC_EnableIRQ:
   \   00000000   0xB410             PUSH     {R4}
   \   00000002   0xB240             SXTB     R0,R0            ;; SignExt  R0,R0,#+24,#+24
   \   00000004   0x0941             LSRS     R1,R0,#+5
   \   00000006   0x....             LDR.N    R2,??DataTable3  ;; 0xe000e100
   \   00000008   0x2301             MOVS     R3,#+1
   \   0000000A   0xF010 0x041F      ANDS     R4,R0,#0x1F
   \   0000000E   0x40A3             LSLS     R3,R3,R4
   \   00000010   0xF842 0x3021      STR      R3,[R2, R1, LSL #+2]
   \   00000014   0xBC10             POP      {R4}
   \   00000016   0x4770             BX       LR               ;; return

   \                                 In section .text, align 2, keep-with-next
   \   static __interwork __softfp void NVIC_SetPriority(IRQn_Type, uint32_t)
   \                     NVIC_SetPriority:
   \   00000000   0xB240             SXTB     R0,R0            ;; SignExt  R0,R0,#+24,#+24
   \   00000002   0x2800             CMP      R0,#+0
   \   00000004   0xD508             BPL.N    ??NVIC_SetPriority_0
   \   00000006   0xB240             SXTB     R0,R0            ;; SignExt  R0,R0,#+24,#+24
   \   00000008   0xF010 0x020F      ANDS     R2,R0,#0xF
   \   0000000C   0x....             LDR.N    R3,??DataTable3_1  ;; 0xe000ed18
   \   0000000E   0x18D2             ADDS     R2,R2,R3
   \   00000010   0x00CB             LSLS     R3,R1,#+3
   \   00000012   0xF802 0x3C04      STRB     R3,[R2, #-4]
   \   00000016   0xE003             B.N      ??NVIC_SetPriority_1
   \                     ??NVIC_SetPriority_0:
   \   00000018   0xB240             SXTB     R0,R0            ;; SignExt  R0,R0,#+24,#+24
   \   0000001A   0x....             LDR.N    R2,??DataTable3_2  ;; 0xe000e400
   \   0000001C   0x00CB             LSLS     R3,R1,#+3
   \   0000001E   0x5483             STRB     R3,[R0, R2]
   \                     ??NVIC_SetPriority_1:
   \   00000020   0x4770             BX       LR               ;; return
      3          
      4          extern unsigned char g_aSPI_Data_Buf[];
      5          extern unsigned char buf_sp;
      6          extern unsigned char Radio_Type;
      7          // SSP Configuration structure variable

   \                                 In section .bss, align 4
      8          SSP_CFG_Type SSP_ConfigStruct;
   \                     SSP_ConfigStruct:
   \   00000000                      DS8 24
      9          
     10          /*----------------- INTERRUPT SERVICE ROUTINES --------------------------*/
     11          /*********************************************************************//**
     12          * @brief 		SSP1 Interrupt used for reading and writing handler
     13          * @param		None
     14          * @return 		None
     15          ***********************************************************************/

   \                                 In section .text, align 2, keep-with-next
     16          void SSP1_IRQHandler(void)
     17          {
   \                     SSP1_IRQHandler:
   \   00000000   0xB510             PUSH     {R4,LR}
     18            uint16_t tmp;
     19            /*uint8_t dataword;
     20            if(SSP_GetDataSize(LPC_SSP1)>8)
     21            dataword = 1;
     22          	else
     23            dataword = 0;*///delete by xxw 20140815 消除警告 这个没有用
     24            tmp = SSP_GetRawIntStatusReg(LPC_SSP1);
   \   00000002   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40030000
   \   00000004   0x.... 0x....      BL       SSP_GetRawIntStatusReg
   \   00000008   0x0004             MOVS     R4,R0
     25            // Check overrun error
     26            if (tmp & SSP_RIS_ROR)
   \   0000000A   0x07E0             LSLS     R0,R4,#+31
   \   0000000C   0xD503             BPL.N    ??SSP1_IRQHandler_0
     27            {
     28              // Clear interrupt
     29              SSP_ClearIntPending(LPC_SSP1, SSP_INTCLR_ROR);
   \   0000000E   0x2101             MOVS     R1,#+1
   \   00000010   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40030000
   \   00000012   0x.... 0x....      BL       SSP_ClearIntPending
     30              
     31            }
     32            if (tmp & SSP_RIS_RT)
   \                     ??SSP1_IRQHandler_0:
   \   00000016   0x07A0             LSLS     R0,R4,#+30
   \   00000018   0xD503             BPL.N    ??SSP1_IRQHandler_1
     33            {
     34              // Clear interrupt
     35              SSP_ClearIntPending(LPC_SSP1, SSP_INTCLR_RT);
   \   0000001A   0x2102             MOVS     R1,#+2
   \   0000001C   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40030000
   \   0000001E   0x.... 0x....      BL       SSP_ClearIntPending
     36              
     37            }
     38            while (SSP_GetStatus(LPC_SSP1, SSP_STAT_RXFIFO_NOTEMPTY))
   \                     ??SSP1_IRQHandler_1:
   \   00000022   0x2104             MOVS     R1,#+4
   \   00000024   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40030000
   \   00000026   0x.... 0x....      BL       SSP_GetStatus
   \   0000002A   0x2800             CMP      R0,#+0
   \   0000002C   0xD01E             BEQ.N    ??SSP1_IRQHandler_2
     39            {
     40              // Read data from SSP data
     41              tmp = SSP_ReceiveData(LPC_SSP1);
   \   0000002E   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40030000
   \   00000030   0x.... 0x....      BL       SSP_ReceiveData
   \   00000034   0x0004             MOVS     R4,R0
     42              if(Radio_Type == R_F45M_RECV_RADIO)//-45M	
   \   00000036   0x....             LDR.N    R0,??DataTable3_4
   \   00000038   0x7800             LDRB     R0,[R0, #+0]
   \   0000003A   0x2801             CMP      R0,#+1
   \   0000003C   0xD10C             BNE.N    ??SSP1_IRQHandler_3
     43                g_aSPI_Data_Buf[buf_sp++] = ~(uint8_t)tmp;
   \   0000003E   0x....             LDR.N    R0,??DataTable3_5
   \   00000040   0x7800             LDRB     R0,[R0, #+0]
   \   00000042   0x....             LDR.N    R1,??DataTable3_6
   \   00000044   0x0022             MOVS     R2,R4
   \   00000046   0xB2D2             UXTB     R2,R2            ;; ZeroExt  R2,R2,#+24,#+24
   \   00000048   0x43D2             MVNS     R2,R2
   \   0000004A   0x5442             STRB     R2,[R0, R1]
   \   0000004C   0x....             LDR.N    R0,??DataTable3_5
   \   0000004E   0x7800             LDRB     R0,[R0, #+0]
   \   00000050   0x1C40             ADDS     R0,R0,#+1
   \   00000052   0x....             LDR.N    R1,??DataTable3_5
   \   00000054   0x7008             STRB     R0,[R1, #+0]
   \   00000056   0xE7E4             B.N      ??SSP1_IRQHandler_1
     44              else
     45                g_aSPI_Data_Buf[buf_sp++] = (uint8_t)tmp;
   \                     ??SSP1_IRQHandler_3:
   \   00000058   0x....             LDR.N    R0,??DataTable3_5
   \   0000005A   0x7800             LDRB     R0,[R0, #+0]
   \   0000005C   0x....             LDR.N    R1,??DataTable3_6
   \   0000005E   0x5444             STRB     R4,[R0, R1]
   \   00000060   0x....             LDR.N    R0,??DataTable3_5
   \   00000062   0x7800             LDRB     R0,[R0, #+0]
   \   00000064   0x1C40             ADDS     R0,R0,#+1
   \   00000066   0x....             LDR.N    R1,??DataTable3_5
   \   00000068   0x7008             STRB     R0,[R1, #+0]
   \   0000006A   0xE7DA             B.N      ??SSP1_IRQHandler_1
     46            }
     47          }
   \                     ??SSP1_IRQHandler_2:
   \   0000006C   0xBD10             POP      {R4,PC}          ;; return
     48          

   \                                 In section .text, align 2, keep-with-next
     49          void SPI_Init(void)
     50          {
   \                     SPI_Init:
   \   00000000   0xB510             PUSH     {R4,LR}
     51            uint32_t tmp;
     52            
     53            Board_RRADIO_Control_Init();
   \   00000002   0x.... 0x....      BL       Board_RRADIO_Control_Init
     54            PINSEL_ConfigPin(0, 6, 2);
   \   00000006   0x2202             MOVS     R2,#+2
   \   00000008   0x2106             MOVS     R1,#+6
   \   0000000A   0x2000             MOVS     R0,#+0
   \   0000000C   0x.... 0x....      BL       PINSEL_ConfigPin
     55            
     56            PINSEL_ConfigPin(0, 7, 2);
   \   00000010   0x2202             MOVS     R2,#+2
   \   00000012   0x2107             MOVS     R1,#+7
   \   00000014   0x2000             MOVS     R0,#+0
   \   00000016   0x.... 0x....      BL       PINSEL_ConfigPin
     57            PINSEL_SetFilter(0, 7, 0);
   \   0000001A   0x2200             MOVS     R2,#+0
   \   0000001C   0x2107             MOVS     R1,#+7
   \   0000001E   0x2000             MOVS     R0,#+0
   \   00000020   0x.... 0x....      BL       PINSEL_SetFilter
     58            
     59            PINSEL_ConfigPin(0, 8, 2);
   \   00000024   0x2202             MOVS     R2,#+2
   \   00000026   0x2108             MOVS     R1,#+8
   \   00000028   0x2000             MOVS     R0,#+0
   \   0000002A   0x.... 0x....      BL       PINSEL_ConfigPin
     60            PINSEL_SetFilter(0, 8, 0);
   \   0000002E   0x2200             MOVS     R2,#+0
   \   00000030   0x2108             MOVS     R1,#+8
   \   00000032   0x2000             MOVS     R0,#+0
   \   00000034   0x.... 0x....      BL       PINSEL_SetFilter
     61            
     62            PINSEL_ConfigPin(0, 9, 2);
   \   00000038   0x2202             MOVS     R2,#+2
   \   0000003A   0x2109             MOVS     R1,#+9
   \   0000003C   0x2000             MOVS     R0,#+0
   \   0000003E   0x.... 0x....      BL       PINSEL_ConfigPin
     63            PINSEL_SetFilter(0, 9, 0);
   \   00000042   0x2200             MOVS     R2,#+0
   \   00000044   0x2109             MOVS     R1,#+9
   \   00000046   0x2000             MOVS     R0,#+0
   \   00000048   0x.... 0x....      BL       PINSEL_SetFilter
     64            
     65            //* Initializing SSP device section ------------------------------------------------------ */
     66            // initialize SSP configuration structure to default
     67            SSP_ConfigStructInit(&SSP_ConfigStruct);
   \   0000004C   0x....             LDR.N    R0,??DataTable3_7
   \   0000004E   0x.... 0x....      BL       SSP_ConfigStructInit
     68            SSP_ConfigStruct.CPHA = SSP_CPHA_SECOND;
   \   00000052   0x....             LDR.N    R0,??DataTable3_7
   \   00000054   0x2180             MOVS     R1,#+128
   \   00000056   0x6041             STR      R1,[R0, #+4]
     69            SSP_ConfigStruct.CPOL = SSP_CPOL_LO;
   \   00000058   0x....             LDR.N    R0,??DataTable3_7
   \   0000005A   0x2140             MOVS     R1,#+64
   \   0000005C   0x6081             STR      R1,[R0, #+8]
     70            // Initialize SSP peripheral with parameter given in structure above
     71            SSP_Init(LPC_SSP1, &SSP_ConfigStruct);
   \   0000005E   0x....             LDR.N    R1,??DataTable3_7
   \   00000060   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40030000
   \   00000062   0x.... 0x....      BL       SSP_Init
     72            
     73            // Enable SSP peripheral
     74            SSP_Cmd(LPC_SSP1, ENABLE);
   \   00000066   0x2101             MOVS     R1,#+1
   \   00000068   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40030000
   \   0000006A   0x.... 0x....      BL       SSP_Cmd
     75            
     76            // preemption = 1, sub-priority = 1 //
     77            NVIC_SetPriority(SSP1_IRQn, ((0x01<<4)|0x0e));
   \   0000006E   0x211E             MOVS     R1,#+30
   \   00000070   0x200F             MOVS     R0,#+15
   \   00000072   0x.... 0x....      BL       NVIC_SetPriority
     78            // Enable SSP0 interrupt //
     79            NVIC_EnableIRQ(SSP1_IRQn);
   \   00000076   0x200F             MOVS     R0,#+15
   \   00000078   0x.... 0x....      BL       NVIC_EnableIRQ
     80            
     81            // Clear all remaining data in RX FIFO //
     82            while (LPC_SSP1->SR & SSP_SR_RNE)
   \                     ??SPI_Init_0:
   \   0000007C   0x....             LDR.N    R0,??DataTable3_8  ;; 0x4003000c
   \   0000007E   0x6800             LDR      R0,[R0, #+0]
   \   00000080   0x0740             LSLS     R0,R0,#+29
   \   00000082   0xD504             BPL.N    ??SPI_Init_1
     83            {
     84              tmp = (uint32_t) SSP_ReceiveData(LPC_SSP1);
   \   00000084   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40030000
   \   00000086   0x.... 0x....      BL       SSP_ReceiveData
   \   0000008A   0x0004             MOVS     R4,R0
   \   0000008C   0xE7F6             B.N      ??SPI_Init_0
     85            }
     86            tmp = tmp;//add by xxw 20140815 消除警告
     87            // Clear status
     88            LPC_SSP1->ICR = SSP_ICR_BITMASK;
   \                     ??SPI_Init_1:
   \   0000008E   0x....             LDR.N    R0,??DataTable3_9  ;; 0x40030020
   \   00000090   0x2103             MOVS     R1,#+3
   \   00000092   0x6001             STR      R1,[R0, #+0]
     89            SSP_IntConfig(LPC_SSP1, SSP_INTCFG_ROR|SSP_INTCFG_RT|SSP_INTCFG_RX, ENABLE);
   \   00000094   0x2201             MOVS     R2,#+1
   \   00000096   0x2107             MOVS     R1,#+7
   \   00000098   0x....             LDR.N    R0,??DataTable3_3  ;; 0x40030000
   \   0000009A   0x.... 0x....      BL       SSP_IntConfig
     90          }
   \   0000009E   0xBD10             POP      {R4,PC}          ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3:
   \   00000000   0xE000E100         DC32     0xe000e100

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_1:
   \   00000000   0xE000ED18         DC32     0xe000ed18

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_2:
   \   00000000   0xE000E400         DC32     0xe000e400

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_3:
   \   00000000   0x40030000         DC32     0x40030000

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_4:
   \   00000000   0x........         DC32     Radio_Type

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_5:
   \   00000000   0x........         DC32     buf_sp

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_6:
   \   00000000   0x........         DC32     g_aSPI_Data_Buf

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_7:
   \   00000000   0x........         DC32     SSP_ConfigStruct

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_8:
   \   00000000   0x4003000C         DC32     0x4003000c

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable3_9:
   \   00000000   0x40030020         DC32     0x40030020

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
       4   NVIC_EnableIRQ
       0   NVIC_SetPriority
       8   SPI_Init
         8   -> Board_RRADIO_Control_Init
         8   -> NVIC_EnableIRQ
         8   -> NVIC_SetPriority
         8   -> PINSEL_ConfigPin
         8   -> PINSEL_SetFilter
         8   -> SSP_Cmd
         8   -> SSP_ConfigStructInit
         8   -> SSP_Init
         8   -> SSP_IntConfig
         8   -> SSP_ReceiveData
       8   SSP1_IRQHandler
         8   -> SSP_ClearIntPending
         8   -> SSP_GetRawIntStatusReg
         8   -> SSP_GetStatus
         8   -> SSP_ReceiveData


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable3
       4  ??DataTable3_1
       4  ??DataTable3_2
       4  ??DataTable3_3
       4  ??DataTable3_4
       4  ??DataTable3_5
       4  ??DataTable3_6
       4  ??DataTable3_7
       4  ??DataTable3_8
       4  ??DataTable3_9
      24  NVIC_EnableIRQ
      34  NVIC_SetPriority
     160  SPI_Init
     110  SSP1_IRQHandler
      24  SSP_ConfigStruct

 
  24 bytes in section .bss
 368 bytes in section .text
 
 368 bytes of CODE memory
  24 bytes of DATA memory

Errors: none
Warnings: none
